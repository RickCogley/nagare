# /examples Directory - Usage Examples

## Purpose

This directory contains practical examples demonstrating how to use Nagare in various scenarios.
Each example is a working project that showcases different features and configuration options.

## Example Projects

### Basic Examples

- **basic-npm/** - Simple npm package release
  - Minimal nagare.config.ts
  - Standard package.json updates
  - Basic changelog generation
  - Git tag and GitHub release

- **basic-deno/** - Deno module release
  - JSR publishing configuration
  - Version.ts file updates
  - Deno-specific workflows
  - Import map management

### Advanced Examples

- **monorepo/** - Monorepo release management
  - Multiple package coordination
  - Workspace version updates
  - Synchronized releases
  - Dependency management

- **custom-templates/** - Custom template usage
  - Modified changelog formats
  - Project-specific version files
  - Template variable examples
  - Multiple template types

- **ci-integration/** - CI/CD pipeline integration
  - GitHub Actions workflow
  - Automated releases
  - Error handling with auto-fix
  - Release conditions

- **international/** - Multi-language project
  - Japanese changelog generation
  - Bilingual release notes
  - Language-specific templates
  - I18n configuration

### Framework-Specific Examples

- **react-app/** - React application releases
  - Package.json and build integration
  - Environment variable updates
  - Build number tracking
  - CDN deployment preparation

- **rust-crate/** - Rust project integration
  - Cargo.toml version updates
  - Cargo publish workflow
  - Cross-language changelog
  - Git tag conventions

- **python-package/** - Python package releases
  - setup.py/pyproject.toml updates
  - PyPI publishing preparation
  - Version.py generation
  - Wheel building integration

## Example Structure

Each example follows this structure:

```
example-name/
‚îú‚îÄ‚îÄ nagare.config.ts    # Nagare configuration
‚îú‚îÄ‚îÄ package.json        # Or relevant package file
‚îú‚îÄ‚îÄ README.md          # Example documentation
‚îú‚îÄ‚îÄ .gitignore         # Git ignore rules
‚îî‚îÄ‚îÄ src/              # Example source code
```

## Configuration Patterns

### Minimal Configuration

```typescript
// examples/basic-npm/nagare.config.ts
export default {
  project: {
    name: "my-package",
    version: "1.0.0",
  },
};
```

### Advanced Configuration

```typescript
// examples/custom-templates/nagare.config.ts
export default {
  project: {
    name: "advanced-project",
    version: "2.0.0",
    repository: "https://github.com/user/repo",
  },
  versionFile: {
    path: "./version.ts",
    template: "custom-version.vento",
  },
  updateFiles: [
    { path: "./package.json", type: "json" },
    { path: "./src/version.ts", type: "typescript" },
    { path: "./docs/config.yaml", type: "yaml" },
  ],
  changelog: {
    template: "detailed-changelog.vento",
    sections: {
      breaking: "üí• Breaking Changes",
      features: "‚ú® New Features",
      fixes: "üêõ Bug Fixes",
    },
  },
  hooks: {
    preRelease: "deno test && deno lint",
    postRelease: "deno run -A scripts/notify.ts",
  },
};
```

## Running Examples

### Local Testing

```bash
# Clone and enter example
cd examples/basic-npm

# Initialize git (if needed)
git init
git add .
git commit -m "Initial commit"

# Run Nagare
deno run -A ../../cli.ts release patch --dry-run
```

### Using Published Version

```bash
# Install Nagare globally
deno install -A -n nagare jsr:@rick/nagare/cli

# Run in example
cd examples/basic-npm
nagare release patch
```

## Common Scenarios

### First Release

Examples show how to handle:

- No previous tags
- Initial version setting
- First changelog entry
- GitHub repository setup

### Continuous Releases

- Incremental version bumps
- Changelog accumulation
- Tag management
- Release asset handling

### Recovery Scenarios

- Failed release recovery
- Rollback examples
- Retry workflows
- Manual intervention

## Template Examples

### Custom Changelog

```vento
# {{ projectName }} Changelog

{{ for release of releases }}
## [{{ release.version }}] - {{ release.date }}

{{ if release.breaking }}
### ‚ö†Ô∏è BREAKING CHANGES
{{ for change of release.breaking }}
- {{ change }}
{{ /for }}
{{ /if }}

### What's New
{{ for feature of release.features }}
- {{ feature }}
{{ /for }}

{{ /for }}
```

### Version File Template

```vento
// Auto-generated by Nagare
export const VERSION = "{{ version }}";
export const RELEASE_DATE = "{{ date }}";
export const BUILD_NUMBER = {{ buildNumber }};
```

## Integration Examples

### GitHub Actions

```yaml
# .github/workflows/release.yml
name: Release
on:
  push:
    branches: [main]

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - uses: denoland/setup-deno@v1

      - name: Create Release
        run: |
          deno run -A jsr:@rick/nagare/cli release \
            --skip-confirmation \
            --config ./nagare.config.ts
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

### Pre-commit Hooks

```bash
#!/bin/sh
# .git/hooks/pre-commit
deno run -A jsr:@rick/nagare/cli release patch --dry-run
```

## Best Practices Demonstrated

### Security

- Input validation in configs
- Safe template usage
- Secure credential handling
- OWASP compliance examples

### Error Handling

- Graceful failure recovery
- Clear error messages
- Rollback procedures
- State consistency

### Performance

- Efficient file updates
- Minimal git operations
- Cached template compilation
- Parallel processing

## Learning Path

1. **Start Simple** - basic-npm example
2. **Add Complexity** - custom-templates
3. **Framework Integration** - react-app or rust-crate
4. **CI/CD** - ci-integration
5. **Advanced** - monorepo

## Validation

All examples are:

- Tested with each release
- Include working configs
- Have clear documentation
- Show real-world usage
- Follow best practices

## Contributing Examples

To add new examples:

1. Create directory under /examples
2. Include working nagare.config.ts
3. Add comprehensive README.md
4. Test all workflows
5. Submit with documentation

When studying examples:

1. Read the README first
2. Examine the configuration
3. Try dry-run mode
4. Modify for your needs
5. Test thoroughly
